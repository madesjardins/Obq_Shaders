<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=UTF-8" />
<title>Obq Arnold Shaders-Obq_Toon</title>
<meta http-equiv="Content-Language" content="en-us" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="MSSmartTagsPreventParsing" content="true" />
<meta name="description" content="Obq_Shaders for Arnold" />
<meta name="keywords" content="Obq_Shaders" />
<meta name="author" content="Marc-Antoine Desjardins - Oblique FX" />
<style type="text/css" media="all">@import "../css/master.css";</style>
</head>
<body>
<div id="page-container">
<div id="banner"><img src="../images/banner.jpg" alt="Banner"></div>
<div id="topMenu">
<div id="topMenu-left">
<a href="http://www.obliquefx.com"><img src="../images/oblique.png" alt="Oblique Logo" width = "150px"></a></div>
<div id="topMenu-right"><table border="0" cellpadding="9" cellspacing="0"><tr>
<td width="50"> </td>
<td><a href="../index.html">Home</a></td>
<td>|</td>
<td><a href="../news.html">News</a></td>
<td>|</td>
<td><a href="../documentation.html">Documentation</a></td>
<td>|</td>
<td><a href="../downloads.html">Downloads</a></td>
<td>|</td>
<td><a href="../about.html">About</a></td>
<td width="50"> </td>
</tr></table>
</div>
</div>
<div id="content">
<div id="content-sidebar">
<p align="left">Node Reference</p>
<table border="0" cellpadding ="2" cellspacing ="0">
<tr><td width="2"></td><td><a href="Obq_AngularCamera.html">Obq_AngularCamera</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_Atmosphere.html">Obq_Atmosphere</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_Bend4Stereo.html">Obq_Bend4Stereo</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_ChangeRange.html">Obq_ChangeRange</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_Environment.html">Obq_Environment</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_Etching.html">Obq_Etching</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_Fresnel.html">Obq_Fresnel</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_Hair.html">Obq_Hair</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_IESLightFilter.html">Obq_IESLightFilter</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_MeasuredMaterial.html">Obq_MeasuredMaterial</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_MessageFlt.html">Obq_MessageFlt</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_Opacity.html">Obq_Opacity</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_RandomColor.html">Obq_RandomColor</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_RGBComEmit.html">Obq_RGBComEmit</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_RGBComLightFilter.html">Obq_RGBComLightFilter</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_Root2Tip.html">Obq_Root2Tip</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_Shadow.html">Obq_Shadow</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_Simbiont.html">Obq_Simbiont</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_StereoLens.html">Obq_StereoLens</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_SurfaceEnvironment.html">Obq_SurfaceEnvironment</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_Thickness.html">Obq_Thickness</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_Toon.html">Obq_Toon</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_ToonSimple.html">Obq_ToonSimple</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_TransformUV.html">Obq_TransformUV</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_UVRemapLensDistortion.html">Obq_UVRemapLensDistortion</a></td></tr>
<tr><td width="2"></td><td><a href="Obq_VolumeThickness.html">Obq_VolumeThickness</a></td></tr>
</table>
</div>
<div id="content-help"><br>
<h2>Obq_Toon</h2>
<br>
<h5>Class</h5>
<p>Material</p>
<br>
<h5>Output</h5>
<p>Color RGB</p>
<br>
<h5>Synopsis</h5>
<p>A toon shader with a lot of options. A dot product for each component (diffuse = NdotL, highlight = NdotH and rimlight = NdotV) is calculated to determine the shading and then remapped according to some rules. You can, for example, remap the shading with a gradient node or a gradient in an image. This way, you can create specific toon looks and funky highlights.</p>
<br>
<img src="images/Obq_Toon_01.jpg" alt="Synopsis image" width=512 >
<p class="idesc">A simple toon example.</p>
<br>
<h5>Usage</h5>
<p>For a classic toon look, use it exactly like the Mental Ray toon shader with the coverage and softness parameters. If you want to remap using a gradient, you must use the <em>Gradient</em> node from the <em>Mixers - Processing</em> group and use an <em>Obq_MessageFlt</em> node with <em>Obq_Toon</em> preset as <em>input</em>. The port is only accessible via the render tree.</p>
<br>
<img src="images/Obq_Toon_02.jpg" alt="Usage" width=512 >
<p class="idesc">Obq_Toon using a gradient to remap diffuse and an image to remap highlight.</p>
<p class="note" >Note : Alpha values of images and gradients are not used, you should fade to back towards U=0.</p>
<br>
<hr/>
<h4>Globals</h4>
<br>
<h5>Ambient Color <em>[ambient_color]</em></h5>
<p>This is a simple constant.</p>
<br>
<h5>Ambient Scale <em>[ambient_scale]</em></h5>
<p>Let's you adjust the Ambient mix.</p>
<br>
<h5>Multiply by scene ambience <em>[ambient_multAmbience]</em></h5>
<p>When checked, this multiplies the ambient color by the scene ambience.</p>
<br>
<h5>No Internal Ambient <em>[ambient_noInternal]</em></h5>
<p>With a non-opaque object, check this to disable the ambient contribution of back-facing polygons. See <em>opacity</em> for example.</p>
<br>
<h5>Opacity Color <em>[opacity]</em></h5>
<p>This is the opacity of the shader.</p>
<p class="note" >Note : Use the <em>No Internal</em> component parameters to activate or deactivate contribution of back-facing polygons.</p>
<br>
<img src="images/Obq_Toon_07.jpg" alt="Opacity and no internal" width=512 >
<p class="idesc">Left is an opaque sphere, in the middle a semi-opaque sphere and right, semi-opaque sphere with all <em>_noInternal</em> checked.</p>
<br>
<h5>Compositing <em>[global_compMode]</em></h5>
<p>This tells the shader how to composite ambient, diffuse, highlight and rimlight results together in that order.</p>
<table borders="0" cellpadding=0 cellspacing=0 width=700>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="40"><span class="enumElem">Add</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">this will add all the results.</td></tr>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="40"><span class="enumElem">Over</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">this will mix the results one by one using the rule : out = A + (1-A.alpha)*out, where A.alpha is the channel with the greatest value.</td></tr>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="40"><span class="enumElem">Max</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">for each channel, the greatest value of the components will be used.</td></tr>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="40"><span class="enumElem">Screen</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">for each channel, out = A + out - A*out for values of A and out [0,1], else the greatest value between the two.</td></tr>
</table>
<br>
<img src="images/Obq_Toon_05.jpg" alt="global_compMode" width=512 >
<p class="idesc">A sphere with grey diffuse, reddish highlight and bluish rimlight. From left to right: <em>Add</em>, <em>Over</em>, <em>Max</em> and <em>Screen</em> mode. There is no apparent highlight on the third sphere because the red channel of the diffuse is higher than the red channel of the highlight.</p>
<br>
<h5>Loop Mode <em>[global_loopMode]</em></h5>
<p>This allows the user to evaluate the shading+remap either at each light samples or after all the lights were sampled. This is useful to change the look of multiple lights setups.</p>
<table borders="0" cellpadding=0 cellspacing=0 width=700>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="105"><span class="enumElem">Add all values</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">this is what you would expect normally, the shading+remap is calculated for each light sample and then added.</td></tr>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="105"><span class="enumElem">Use sum for value</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">The sum of the samples will be use to calculate shading+remap.</td></tr>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="105"><span class="enumElem">Use max for value</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">The single greatest value of the samples will be use to calculate shading+remap.</td></tr>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="105"><span class="enumElem">Remap value</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">This is a little bit like the second option; shading is calculated at each sample, but remapped only at the end.</td></tr>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="105"><span class="enumElem">Remap inputs</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">This is like <em>Remap value</em> but instead of using built-in shading, it uses the <em>_shaderInput</em> port as value. Only diffuse and highlight ports are available.</td></tr>
</table>
<br>
<img src="images/Obq_Toon_06.jpg" alt="global_loopMode" width=512 >
<p class="idesc">Sphere and ground lit by 3 lights of intensities 0.5, 0.75 and 1. From left to right : <em>Add all values</em>, <em>Use sum for value</em>, <em>Use max for value</em> and <em>Remap value</em>. From top to bottom, Global Loop Light Mode : <em>Add</em>, <em>Add (Clamped)</em>, <em>Maximum</em> and <em>Multiply</em>.</p>
<p class="note" >Note : When using <em>Remap inputs</em>, remap parameters <em>Coverage</em>, <em>Softness</em> and <em>Exponent</em> are still activated, so you should have them equal 1.</p>
<br>
<h5>Lights <em>[global_loopLightMode]</em></h5>
<p>Enabled when using options 2 or 3 from the previous parameter. This tells the shader what to do with the light samples.</p>
<table borders="0" cellpadding=0 cellspacing=0 width=700>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="90"><span class="enumElem">Add</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">add all the light samples.</td></tr>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="90"><span class="enumElem">Add (Clamped)</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">add all the light samples but clamp to one.</td></tr>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="90"><span class="enumElem">Maximum</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">use the single greatest light sample.</td></tr>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="90"><span class="enumElem">Multiply</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">multiply them all together.</td></tr>
</table>
<br>
<h5>Remap <em>[global_remapMode]</em></h5>
<p>Enabled when using one of the two remap loop modes. This tells the shader what to do with the input shaders.</p>
<table borders="0" cellpadding=0 cellspacing=0 width=700>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="110"><span class="enumElem">Use Average</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">use the average RGB intensities of the input as dot.</td></tr>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="110"><span class="enumElem">Use Luminance</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">use the luminance of the input as dot using the equation : <br>Luminance = 0.2126*R + 0.7152*G + 0.0722*B.</td></tr>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="110"><span class="enumElem">Use Each Channel</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">calculates the dot for each channel and remaps them.</td></tr>
</table>
<p class="note" >Note : Only diffuse and highlight ports are available and evaluation is done only if a shader is plugged into the port as optimization.</p>
<br>
<img src="images/Obq_Toon_10.jpg" alt="Remap Inputs" width=512 >
<p class="idesc">From left to right : input standard, <em>Use Average</em>, <em>Use Luminance</em> and <em>Use Each Channel</em>. From top to buttom, multiplied by normalized input color : unchecked and checked.</p>
<br>
<h5>Multiply by Normalized Input Color <em>[global_remapMultByColor]</em></h5>
<p>When checked, this multiplies the result by the HSV color of the input using V=1.</p>
<p class="note" >Note : This is only enabled with the two remap loop modes in <em>Use Average</em> or <em>Use Luminance</em> remap modes.</p>
<br>
<h5>Multiply by Light Color <em>[global_multByLightColor]</em></h5>
<p>When checked, this multiplies all light samples by the light color.</p>
<p class="note" >Note : In theory, this should always be checked. If it's off, you wont have any shadows.</p>
<br>
<h5>Clamp Before Compositing <em>[global_clamp]</em></h5>
<p>When checked, this clamps the values of the accumulated results before compositing a new component.</p>
<p class="note" >Note : This helps solidify colors.</p>
<br>
<h5>Check To Render Map Image (Use diffuse) <em>[output_imageOnUV]</em></h5>
<p>With this checked, you can render map the gradient or the remapped image of the <em>Diffuse</em> tab. Simply create a grid, assign the material of the object with the desired gradient, for example, add planar XZ texture projection, enable this option and do a render map using Kettle Bake.</p>
<p class="note" >Note : Once this is done, you should add 2 pixels to the left of the image with the same value as the previously first pixel and do the same to the right with the last pixel.</p>
<br>
<hr/>
<h4>Diffuse/Highlight/Rimlight</h4>
<p>The diffuse component uses the N dot L of the Lambertian model, the highlight component uses the N dot H of the Blinn-Phong model and the rimlight uses the N dot V to to determine shading. Once this shading is calculated, it is remapped with respect to the <em>Mode</em>.</p>
<br>
<h5>Color <em>[_color]</em></h5>
<p>This is the color of the diffuse component.</p>
<br>
<h5>Scale <em>[_scale]</em></h5>
<p>This is the scale of the diffuse component.</p>
<br>
<h5>Exponent <em>[highlight_exponent]</em></h5>
<p>The bigger the exponent, the smaller the highlight.</p>
<br>
<h5>Coverage <em>[_coverage]</em></h5>
<p>This will somewhat scale down the span of the lit portion of the object.</p>
<br>
<img src="images/Obq_Toon_03.jpg" alt="Coverage" width=512 >
<p class="idesc">Different values of <em>Coverage</em> = {1.0, 0.5, 0.25, 0.0}.</p>
<p class="note" >Note : dot = 1-(1-dot)/coverage</p>
<br>
<h5>Softness <em>[_softness]</em></h5>
<p>This will somewhat push highest values down. Use a value of 0 for a classic toon look.</p>
<br>
<img src="images/Obq_Toon_04.jpg" alt="Softness" width=512 >
<p class="idesc">Different values of <em>Softness</em> = {1.0, 0.5, 0.25, 0.0}.</p>
<p class="note" >Note : dot = dot/softness. When used for highlight, if you put 0 here you should use a <em>Coverage of less than 1,</em></p>
<br>
<h5>No Internal <em>[_noInternal]</em></h5>
<p>This will deactivate contribution of back-facing polygons.</p>
<br>
<h5>Linearize Dot Product <em>[_linearDot]</em></h5>
<p>This will linearize the resulting dot product :  dot= 1-acos(dot)/(pi/2).</p>
<br>
<img src="images/Obq_Toon_08.jpg" alt="Softness" width=512 >
<p class="idesc">Left is not linearized, while right is. The stripes on the right image all have a similar thickness instead of being blown in the green and crunched in the red.</p>
<br>
<h5>Mode <em>[_mode]</em></h5>
<p>This will tell how to remap the dot product. <em>Coverage</em> and <em>Softness</em> are used on all of the modes.</p>
<table borders="0" cellpadding=0 cellspacing=0 width=700>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="50"><span class="enumElem">Parameters</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">Remap is done according to <em>Coverage</em>, <em>Softness</em> and <em>Exponent</em> only.</td></tr>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="50"><span class="enumElem">Image</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">the shading will be remapped using its value as the U of an image.</td></tr>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="50"><span class="enumElem">Gradient</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">the shading will be remapped using its value as the input value of a <em>Gradient</em> node.</td></tr>
</table>
<p class="note" >Note : You must use the <em>Gradient</em> node from the <em>Mixers - Processing</em> group and use as input the <em>Obq_MessageFlt</em> node using the <em>Obq_Toon</em> preset. The port is only accessible via the render tree.</p>
<br>
<h5>Use Auto Remap <em>[_autoRemap]</em></h5>
<p>This will calculate the proper left-right remap based on resolution. Basically, it puts the left border at -2/width and right at 1+2/width to ensure there will be no artefacts.</p>
<p class="note" >Note : When creating image gradients, add 2 pixels to the left of the image with the same value as the previously first pixel and do the same to the right with the last pixel.</p>
<br>
<h5>Remap Left Value <em>[_imageRemapLeft]</em></h5>
<p>This is the U value for the left border of the image.</p>
<p class="note" >Note : Remap is done after <em>Bias</em> and <em>Gain</em>.</p>
<p class="warning">Warning : Using 0 for left and 1 for right will cause artefacts.</p>
<br>
<h5>Remap Right Value <em>[_imageRemapRight]</em></h5>
<p>This is the U value for the left border of the image.</p>
<br>
<h5>Remap Bias <em>[_imageRemapBias]</em></h5>
<p>This bias will be applied to the U value before accessing the image.</p>
<br>
<h5>Remap Gain <em>[_imageRemapGain]</em></h5>
<p>This gain will be applied to the U value before accessing the image.</p>
<br>
<hr/>
<h4>AOVs</h4>
<p>You can also render all components in seperate AOVs.</p>
<p class="note" >Note : If a recently created AOV doesn't show in the list, close the shader UI and reopen it.</p>
<br>
<h5>Create/Set default AOVs with prefix</h5>
<p>Pressing this button will set the AOVs' names, or create them if they do not exist, using the prefix and the default names rule.</p>
<br>
<h5>Contour AOV</h5>
<p>This can help you do contours in compositing by edge detecting its channels.</p>
<table borders="0" cellpadding=0 cellspacing=0 width=700>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="40"><span class="enumElem">Red</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">Depth.</td></tr>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="40"><span class="enumElem">Green</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">Polygon ID.</td></tr>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="40"><span class="enumElem">Blue</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">Object ID.</td></tr>
<tr><td width=15> </td><td width=20 valign="top" align="center">&bull;</td><td valign="top" align="left" width="40"><span class="enumElem">Alpha</span></td><td valign="top" align="center" width = 10>:</td><td valign="top" align="justify">Incidence.</td></tr>
</table>
<p class="note" >Note : Object IDs start at 1 in order to have the background equal 0.</p>
<br>
<h5>Set Alpha to Over Alpha <em>[putAlphaInFb]</em></h5>
<p>When checked, an RGBA AOV will have an alpha equal to the alpha used for compositing in over mode.</p>
<br>
<h5>Normalize Object ID in Contour <em>[normalizeObjectID]</em></h5>
<p>When checked, the object IDs used for the blue channel in the contour AOV will be normalized.</p>
</div>
</div>
<div id="footer">Copyright &copy; 2011-2014, ObliqueFX. All Rights Reserved. </div>
</div>
</body>
</html>
